============================= test session starts =============================
platform win32 -- Python 3.11.9, pytest-7.4.3, pluggy-1.6.0
rootdir: C:\Users\joaov\OneDrive\Ambiente de Trabalho\UA\projeto\WaitTime-Service
plugins: anyio-3.7.1, Faker-20.1.0, asyncio-0.21.1, cov-4.1.0, mock-3.12.0
asyncio: mode=Mode.STRICT
collected 96 items

tests\test_app.py .FF.FFFFFFFFFF..FF..                                   [ 20%]
tests\test_integration.py ....FF...                                      [ 30%]
tests\test_map_service.py .............                                  [ 43%]
tests\test_models.py ................                                    [ 60%]
tests\test_queue_model.py ...................                            [ 80%]
tests\test_repositories.py ...................                           [100%]

================================== FAILURES ===================================
______________ TestWaitTimeEndpoints.test_get_wait_time_success _______________

self = <tests.test_app.TestWaitTimeEndpoints object at 0x000001A88D4D0B90>
test_client = <httpx.AsyncClient object at 0x000001A88DC32790>
test_db_session = <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x000001A88DC316D0>
seed_pois = [{'id': 'WC-Norte-L0-1', 'name': 'Restrooms North Level 0 #1', 'num_servers': 8, 'poi_type': 'restroom', ...}, {'id': ...ype': 'restroom', ...}, {'id': 'Food-Sul-1', 'name': 'Food Court South #1', 'num_servers': 4, 'poi_type': 'food', ...}]
seed_queue_states = [{'arrival_rate': 2.5, 'confidence_lower': 4.0, 'confidence_upper': 6.5, 'current_wait_minutes': 5.2, ...}, {'arrival_... 3.1, ...}, {'arrival_rate': 3.2, 'confidence_lower': 7.0, 'confidence_upper': 10.5, 'current_wait_minutes': 8.7, ...}]

    @pytest.mark.asyncio
    async def test_get_wait_time_success(self, test_client, test_db_session, seed_pois, seed_queue_states):
        """Test getting wait time for a specific POI"""
        # Seed data is already in database
>       response = await test_client.get("/api/waittime?poi=WC-Norte-L0-1")

tests\test_app.py:37: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1757: in get
    return await self.request(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1530: in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1617: in send
    response = await self._send_handling_auth(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1645: in _send_handling_auth
    response = await self._send_handling_redirects(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1682: in _send_handling_redirects
    response = await self._send_single_request(request)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1719: in _send_single_request
    response = await transport.handle_async_request(request)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_transports\asgi.py:162: in handle_async_request
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\applications.py:1106: in __call__
    await super().__call__(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\applications.py:122: in __call__
    await self.middleware_stack(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:184: in __call__
    raise exc
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:162: in __call__
    await self.app(scope, receive, _send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\cors.py:83: in __call__
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:79: in __call__
    raise exc
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:68: in __call__
    await self.app(scope, receive, sender)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:20: in __call__
    raise e
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:17: in __call__
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:718: in __call__
    await route.handle(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:276: in handle
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:66: in app
    response = await func(request)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:274: in app
    raw_response = await run_endpoint_function(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:191: in run_endpoint_function
    return await dependant.call(**values)
app.py:139: in get_wait_time
    wait_time = await repo.get_current_wait_time(poi)
db\repositories.py:158: in get_current_wait_time
    result = await self.session.execute(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\ext\asyncio\session.py:455: in execute
    result = await greenlet_spawn(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py:190: in greenlet_spawn
    result = context.throw(*sys.exc_info())
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2308: in execute
    return self._execute_internal(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2180: in _execute_internal
    conn = self._connection_for_bind(bind)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2047: in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
<string>:2: in _connection_for_bind
    ???
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state_changes.py:139: in _go
    ret_value = fn(self, *arg, **kw)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:1143: in _connection_for_bind
    conn = bind.connect()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:3268: in connect
    return self._connection_cls(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:145: in __init__
    self._dbapi_connection = engine.raw_connection()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:3292: in raw_connection
    return self.pool.connect()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:452: in connect
    return _ConnectionFairy._checkout(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:1269: in _checkout
    fairy = _ConnectionRecord.checkout(pool)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:716: in checkout
    rec = pool._do_get()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\impl.py:169: in _do_get
    with util.safe_reraise():
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:146: in __exit__
    raise exc_value.with_traceback(exc_tb)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\impl.py:167: in _do_get
    return self._create_connection()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:393: in _create_connection
    return _ConnectionRecord(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:678: in __init__
    self.__connect()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:902: in __connect
    with util.safe_reraise():
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:146: in __exit__
    raise exc_value.with_traceback(exc_tb)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:898: in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\create.py:637: in connect
    return dialect.connect(*cargs, **cparams)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\default.py:616: in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py:936: in connect
    await_only(creator_fn(*arg, **kw)),
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py:125: in await_only
    return current.driver.switch(awaitable)  # type: ignore[no-any-return]
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py:185: in greenlet_spawn
    value = await result
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connection.py:2329: in connect
    return await connect_utils._connect(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connect_utils.py:991: in _connect
    conn = await _connect_addr(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connect_utils.py:828: in _connect_addr
    return await __connect_addr(params, True, *args)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

params = ConnectionParameters(user='postgres', password='postgres', database='stadium_waittime', ssl=<ssl.SSLContext object at ...slmode=<SSLMode.prefer: 2>, direct_tls=False, server_settings=None, target_session_attrs=<SessionAttribute.any: 'any'>)
retry = True, addr = ('localhost', 5432)
loop = <ProactorEventLoop running=False closed=False debug=False>
config = ConnectionConfiguration(command_timeout=None, statement_cache_size=100, max_cached_statement_lifetime=300, max_cacheable_statement_size=15360)
connection_class = <class 'asyncpg.connection.Connection'>
record_class = <class 'asyncpg.Record'>
params_input = ConnectionParameters(user='postgres', password='postgres', database='stadium_waittime', ssl=<ssl.SSLContext object at ...slmode=<SSLMode.prefer: 2>, direct_tls=False, server_settings=None, target_session_attrs=<SessionAttribute.any: 'any'>)

    async def __connect_addr(
        params,
        retry,
        addr,
        loop,
        config,
        connection_class,
        record_class,
        params_input,
    ):
        connected = _create_future(loop)
    
        proto_factory = lambda: protocol.Protocol(
            addr, connected, params, record_class, loop)
    
        if isinstance(addr, str):
            # UNIX socket
            connector = loop.create_unix_connection(proto_factory, addr)
    
        elif params.ssl and params.direct_tls:
            # if ssl and direct_tls are given, skip STARTTLS and perform direct
            # SSL connection
            connector = loop.create_connection(
                proto_factory, *addr, ssl=params.ssl
            )
    
        elif params.ssl:
            connector = _create_ssl_connection(
                proto_factory, *addr, loop=loop, ssl_context=params.ssl,
                ssl_is_advisory=params.sslmode == SSLMode.prefer)
        else:
            connector = loop.create_connection(proto_factory, *addr)
    
        tr, pr = await connector
    
        try:
>           await connected
E           asyncpg.exceptions.InvalidPasswordError: password authentication failed for user "postgres"

C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connect_utils.py:876: InvalidPasswordError
_____________ TestWaitTimeEndpoints.test_get_wait_time_not_found ______________

self = <tests.test_app.TestWaitTimeEndpoints object at 0x000001A88DAF0BD0>
test_client = <httpx.AsyncClient object at 0x000001A8906BC690>

    @pytest.mark.asyncio
    async def test_get_wait_time_not_found(self, test_client):
        """Test getting wait time for non-existent POI returns 404"""
>       response = await test_client.get("/api/waittime?poi=NonExistent-POI")

tests\test_app.py:52: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1757: in get
    return await self.request(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1530: in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1617: in send
    response = await self._send_handling_auth(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1645: in _send_handling_auth
    response = await self._send_handling_redirects(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1682: in _send_handling_redirects
    response = await self._send_single_request(request)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1719: in _send_single_request
    response = await transport.handle_async_request(request)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_transports\asgi.py:162: in handle_async_request
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\applications.py:1106: in __call__
    await super().__call__(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\applications.py:122: in __call__
    await self.middleware_stack(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:184: in __call__
    raise exc
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:162: in __call__
    await self.app(scope, receive, _send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\cors.py:83: in __call__
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:79: in __call__
    raise exc
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:68: in __call__
    await self.app(scope, receive, sender)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:20: in __call__
    raise e
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:17: in __call__
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:718: in __call__
    await route.handle(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:276: in handle
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:66: in app
    response = await func(request)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:274: in app
    raw_response = await run_endpoint_function(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:191: in run_endpoint_function
    return await dependant.call(**values)
app.py:139: in get_wait_time
    wait_time = await repo.get_current_wait_time(poi)
db\repositories.py:158: in get_current_wait_time
    result = await self.session.execute(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\ext\asyncio\session.py:455: in execute
    result = await greenlet_spawn(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py:190: in greenlet_spawn
    result = context.throw(*sys.exc_info())
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2308: in execute
    return self._execute_internal(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2180: in _execute_internal
    conn = self._connection_for_bind(bind)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2047: in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
<string>:2: in _connection_for_bind
    ???
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state_changes.py:139: in _go
    ret_value = fn(self, *arg, **kw)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:1143: in _connection_for_bind
    conn = bind.connect()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:3268: in connect
    return self._connection_cls(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:145: in __init__
    self._dbapi_connection = engine.raw_connection()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:3292: in raw_connection
    return self.pool.connect()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:452: in connect
    return _ConnectionFairy._checkout(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:1269: in _checkout
    fairy = _ConnectionRecord.checkout(pool)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:716: in checkout
    rec = pool._do_get()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\impl.py:169: in _do_get
    with util.safe_reraise():
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:146: in __exit__
    raise exc_value.with_traceback(exc_tb)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\impl.py:167: in _do_get
    return self._create_connection()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:393: in _create_connection
    return _ConnectionRecord(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:678: in __init__
    self.__connect()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:902: in __connect
    with util.safe_reraise():
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:146: in __exit__
    raise exc_value.with_traceback(exc_tb)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:898: in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\create.py:637: in connect
    return dialect.connect(*cargs, **cparams)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\default.py:616: in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py:936: in connect
    await_only(creator_fn(*arg, **kw)),
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py:125: in await_only
    return current.driver.switch(awaitable)  # type: ignore[no-any-return]
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py:185: in greenlet_spawn
    value = await result
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connection.py:2329: in connect
    return await connect_utils._connect(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connect_utils.py:991: in _connect
    conn = await _connect_addr(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connect_utils.py:828: in _connect_addr
    return await __connect_addr(params, True, *args)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

params = ConnectionParameters(user='postgres', password='postgres', database='stadium_waittime', ssl=<ssl.SSLContext object at ...slmode=<SSLMode.prefer: 2>, direct_tls=False, server_settings=None, target_session_attrs=<SessionAttribute.any: 'any'>)
retry = True, addr = ('localhost', 5432)
loop = <ProactorEventLoop running=False closed=False debug=False>
config = ConnectionConfiguration(command_timeout=None, statement_cache_size=100, max_cached_statement_lifetime=300, max_cacheable_statement_size=15360)
connection_class = <class 'asyncpg.connection.Connection'>
record_class = <class 'asyncpg.Record'>
params_input = ConnectionParameters(user='postgres', password='postgres', database='stadium_waittime', ssl=<ssl.SSLContext object at ...slmode=<SSLMode.prefer: 2>, direct_tls=False, server_settings=None, target_session_attrs=<SessionAttribute.any: 'any'>)

    async def __connect_addr(
        params,
        retry,
        addr,
        loop,
        config,
        connection_class,
        record_class,
        params_input,
    ):
        connected = _create_future(loop)
    
        proto_factory = lambda: protocol.Protocol(
            addr, connected, params, record_class, loop)
    
        if isinstance(addr, str):
            # UNIX socket
            connector = loop.create_unix_connection(proto_factory, addr)
    
        elif params.ssl and params.direct_tls:
            # if ssl and direct_tls are given, skip STARTTLS and perform direct
            # SSL connection
            connector = loop.create_connection(
                proto_factory, *addr, ssl=params.ssl
            )
    
        elif params.ssl:
            connector = _create_ssl_connection(
                proto_factory, *addr, loop=loop, ssl_context=params.ssl,
                ssl_is_advisory=params.sslmode == SSLMode.prefer)
        else:
            connector = loop.create_connection(proto_factory, *addr)
    
        tr, pr = await connector
    
        try:
>           await connected
E           asyncpg.exceptions.InvalidPasswordError: password authentication failed for user "postgres"

C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connect_utils.py:876: InvalidPasswordError
________________ TestWaitTimeEndpoints.test_get_all_wait_times ________________

self = <tests.test_app.TestWaitTimeEndpoints object at 0x000001A88DAF1B50>
test_client = <httpx.AsyncClient object at 0x000001A8887231D0>
test_db_session = <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x000001A890BD3F10>
seed_pois = [{'id': 'WC-Norte-L0-1', 'name': 'Restrooms North Level 0 #1', 'num_servers': 8, 'poi_type': 'restroom', ...}, {'id': ...ype': 'restroom', ...}, {'id': 'Food-Sul-1', 'name': 'Food Court South #1', 'num_servers': 4, 'poi_type': 'food', ...}]
seed_queue_states = [{'arrival_rate': 2.5, 'confidence_lower': 4.0, 'confidence_upper': 6.5, 'current_wait_minutes': 5.2, ...}, {'arrival_... 3.1, ...}, {'arrival_rate': 3.2, 'confidence_lower': 7.0, 'confidence_upper': 10.5, 'current_wait_minutes': 8.7, ...}]

    @pytest.mark.asyncio
    async def test_get_all_wait_times(self, test_client, test_db_session, seed_pois, seed_queue_states):
        """Test getting all wait times"""
>       response = await test_client.get("/api/waittime/all")

tests\test_app.py:67: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1757: in get
    return await self.request(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1530: in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1617: in send
    response = await self._send_handling_auth(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1645: in _send_handling_auth
    response = await self._send_handling_redirects(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1682: in _send_handling_redirects
    response = await self._send_single_request(request)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1719: in _send_single_request
    response = await transport.handle_async_request(request)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_transports\asgi.py:162: in handle_async_request
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\applications.py:1106: in __call__
    await super().__call__(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\applications.py:122: in __call__
    await self.middleware_stack(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:184: in __call__
    raise exc
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:162: in __call__
    await self.app(scope, receive, _send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\cors.py:83: in __call__
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:79: in __call__
    raise exc
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:68: in __call__
    await self.app(scope, receive, sender)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:20: in __call__
    raise e
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:17: in __call__
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:718: in __call__
    await route.handle(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:276: in handle
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:66: in app
    response = await func(request)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:274: in app
    raw_response = await run_endpoint_function(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:191: in run_endpoint_function
    return await dependant.call(**values)
app.py:165: in get_all_wait_times
    wait_times = await repo.get_all_wait_times(poi_type=poi_type)
db\repositories.py:187: in get_all_wait_times
    result = await self.session.execute(query)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\ext\asyncio\session.py:455: in execute
    result = await greenlet_spawn(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py:190: in greenlet_spawn
    result = context.throw(*sys.exc_info())
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2308: in execute
    return self._execute_internal(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2180: in _execute_internal
    conn = self._connection_for_bind(bind)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2047: in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
<string>:2: in _connection_for_bind
    ???
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state_changes.py:139: in _go
    ret_value = fn(self, *arg, **kw)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:1143: in _connection_for_bind
    conn = bind.connect()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:3268: in connect
    return self._connection_cls(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:145: in __init__
    self._dbapi_connection = engine.raw_connection()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:3292: in raw_connection
    return self.pool.connect()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:452: in connect
    return _ConnectionFairy._checkout(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:1269: in _checkout
    fairy = _ConnectionRecord.checkout(pool)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:716: in checkout
    rec = pool._do_get()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\impl.py:169: in _do_get
    with util.safe_reraise():
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:146: in __exit__
    raise exc_value.with_traceback(exc_tb)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\impl.py:167: in _do_get
    return self._create_connection()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:393: in _create_connection
    return _ConnectionRecord(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:678: in __init__
    self.__connect()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:902: in __connect
    with util.safe_reraise():
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:146: in __exit__
    raise exc_value.with_traceback(exc_tb)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:898: in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\create.py:637: in connect
    return dialect.connect(*cargs, **cparams)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\default.py:616: in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py:936: in connect
    await_only(creator_fn(*arg, **kw)),
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py:125: in await_only
    return current.driver.switch(awaitable)  # type: ignore[no-any-return]
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py:185: in greenlet_spawn
    value = await result
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connection.py:2329: in connect
    return await connect_utils._connect(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connect_utils.py:991: in _connect
    conn = await _connect_addr(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connect_utils.py:828: in _connect_addr
    return await __connect_addr(params, True, *args)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

params = ConnectionParameters(user='postgres', password='postgres', database='stadium_waittime', ssl=<ssl.SSLContext object at ...slmode=<SSLMode.prefer: 2>, direct_tls=False, server_settings=None, target_session_attrs=<SessionAttribute.any: 'any'>)
retry = True, addr = ('localhost', 5432)
loop = <ProactorEventLoop running=False closed=False debug=False>
config = ConnectionConfiguration(command_timeout=None, statement_cache_size=100, max_cached_statement_lifetime=300, max_cacheable_statement_size=15360)
connection_class = <class 'asyncpg.connection.Connection'>
record_class = <class 'asyncpg.Record'>
params_input = ConnectionParameters(user='postgres', password='postgres', database='stadium_waittime', ssl=<ssl.SSLContext object at ...slmode=<SSLMode.prefer: 2>, direct_tls=False, server_settings=None, target_session_attrs=<SessionAttribute.any: 'any'>)

    async def __connect_addr(
        params,
        retry,
        addr,
        loop,
        config,
        connection_class,
        record_class,
        params_input,
    ):
        connected = _create_future(loop)
    
        proto_factory = lambda: protocol.Protocol(
            addr, connected, params, record_class, loop)
    
        if isinstance(addr, str):
            # UNIX socket
            connector = loop.create_unix_connection(proto_factory, addr)
    
        elif params.ssl and params.direct_tls:
            # if ssl and direct_tls are given, skip STARTTLS and perform direct
            # SSL connection
            connector = loop.create_connection(
                proto_factory, *addr, ssl=params.ssl
            )
    
        elif params.ssl:
            connector = _create_ssl_connection(
                proto_factory, *addr, loop=loop, ssl_context=params.ssl,
                ssl_is_advisory=params.sslmode == SSLMode.prefer)
        else:
            connector = loop.create_connection(proto_factory, *addr)
    
        tr, pr = await connector
    
        try:
>           await connected
E           asyncpg.exceptions.InvalidPasswordError: password authentication failed for user "postgres"

C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connect_utils.py:876: InvalidPasswordError
_______ TestWaitTimeEndpoints.test_get_all_wait_times_filtered_by_type ________

self = <tests.test_app.TestWaitTimeEndpoints object at 0x000001A88DAF22D0>
test_client = <httpx.AsyncClient object at 0x000001A88F795590>
test_db_session = <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x000001A88F794150>
seed_pois = [{'id': 'WC-Norte-L0-1', 'name': 'Restrooms North Level 0 #1', 'num_servers': 8, 'poi_type': 'restroom', ...}, {'id': ...ype': 'restroom', ...}, {'id': 'Food-Sul-1', 'name': 'Food Court South #1', 'num_servers': 4, 'poi_type': 'food', ...}]
seed_queue_states = [{'arrival_rate': 2.5, 'confidence_lower': 4.0, 'confidence_upper': 6.5, 'current_wait_minutes': 5.2, ...}, {'arrival_... 3.1, ...}, {'arrival_rate': 3.2, 'confidence_lower': 7.0, 'confidence_upper': 10.5, 'current_wait_minutes': 8.7, ...}]

    @pytest.mark.asyncio
    async def test_get_all_wait_times_filtered_by_type(self, test_client, test_db_session, seed_pois, seed_queue_states):
        """Test getting wait times filtered by POI type"""
>       response = await test_client.get("/api/waittime/all?poi_type=restroom")

tests\test_app.py:84: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1757: in get
    return await self.request(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1530: in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1617: in send
    response = await self._send_handling_auth(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1645: in _send_handling_auth
    response = await self._send_handling_redirects(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1682: in _send_handling_redirects
    response = await self._send_single_request(request)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1719: in _send_single_request
    response = await transport.handle_async_request(request)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_transports\asgi.py:162: in handle_async_request
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\applications.py:1106: in __call__
    await super().__call__(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\applications.py:122: in __call__
    await self.middleware_stack(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:184: in __call__
    raise exc
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:162: in __call__
    await self.app(scope, receive, _send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\cors.py:83: in __call__
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:79: in __call__
    raise exc
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:68: in __call__
    await self.app(scope, receive, sender)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:20: in __call__
    raise e
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:17: in __call__
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:718: in __call__
    await route.handle(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:276: in handle
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:66: in app
    response = await func(request)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:274: in app
    raw_response = await run_endpoint_function(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:191: in run_endpoint_function
    return await dependant.call(**values)
app.py:165: in get_all_wait_times
    wait_times = await repo.get_all_wait_times(poi_type=poi_type)
db\repositories.py:187: in get_all_wait_times
    result = await self.session.execute(query)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\ext\asyncio\session.py:455: in execute
    result = await greenlet_spawn(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py:190: in greenlet_spawn
    result = context.throw(*sys.exc_info())
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2308: in execute
    return self._execute_internal(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2180: in _execute_internal
    conn = self._connection_for_bind(bind)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2047: in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
<string>:2: in _connection_for_bind
    ???
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state_changes.py:139: in _go
    ret_value = fn(self, *arg, **kw)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:1143: in _connection_for_bind
    conn = bind.connect()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:3268: in connect
    return self._connection_cls(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:145: in __init__
    self._dbapi_connection = engine.raw_connection()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:3292: in raw_connection
    return self.pool.connect()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:452: in connect
    return _ConnectionFairy._checkout(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:1269: in _checkout
    fairy = _ConnectionRecord.checkout(pool)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:716: in checkout
    rec = pool._do_get()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\impl.py:169: in _do_get
    with util.safe_reraise():
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:146: in __exit__
    raise exc_value.with_traceback(exc_tb)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\impl.py:167: in _do_get
    return self._create_connection()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:393: in _create_connection
    return _ConnectionRecord(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:678: in __init__
    self.__connect()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:902: in __connect
    with util.safe_reraise():
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:146: in __exit__
    raise exc_value.with_traceback(exc_tb)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:898: in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\create.py:637: in connect
    return dialect.connect(*cargs, **cparams)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\default.py:616: in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py:936: in connect
    await_only(creator_fn(*arg, **kw)),
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py:125: in await_only
    return current.driver.switch(awaitable)  # type: ignore[no-any-return]
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py:185: in greenlet_spawn
    value = await result
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connection.py:2329: in connect
    return await connect_utils._connect(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connect_utils.py:991: in _connect
    conn = await _connect_addr(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connect_utils.py:828: in _connect_addr
    return await __connect_addr(params, True, *args)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

params = ConnectionParameters(user='postgres', password='postgres', database='stadium_waittime', ssl=<ssl.SSLContext object at ...slmode=<SSLMode.prefer: 2>, direct_tls=False, server_settings=None, target_session_attrs=<SessionAttribute.any: 'any'>)
retry = True, addr = ('localhost', 5432)
loop = <ProactorEventLoop running=False closed=False debug=False>
config = ConnectionConfiguration(command_timeout=None, statement_cache_size=100, max_cached_statement_lifetime=300, max_cacheable_statement_size=15360)
connection_class = <class 'asyncpg.connection.Connection'>
record_class = <class 'asyncpg.Record'>
params_input = ConnectionParameters(user='postgres', password='postgres', database='stadium_waittime', ssl=<ssl.SSLContext object at ...slmode=<SSLMode.prefer: 2>, direct_tls=False, server_settings=None, target_session_attrs=<SessionAttribute.any: 'any'>)

    async def __connect_addr(
        params,
        retry,
        addr,
        loop,
        config,
        connection_class,
        record_class,
        params_input,
    ):
        connected = _create_future(loop)
    
        proto_factory = lambda: protocol.Protocol(
            addr, connected, params, record_class, loop)
    
        if isinstance(addr, str):
            # UNIX socket
            connector = loop.create_unix_connection(proto_factory, addr)
    
        elif params.ssl and params.direct_tls:
            # if ssl and direct_tls are given, skip STARTTLS and perform direct
            # SSL connection
            connector = loop.create_connection(
                proto_factory, *addr, ssl=params.ssl
            )
    
        elif params.ssl:
            connector = _create_ssl_connection(
                proto_factory, *addr, loop=loop, ssl_context=params.ssl,
                ssl_is_advisory=params.sslmode == SSLMode.prefer)
        else:
            connector = loop.create_connection(proto_factory, *addr)
    
        tr, pr = await connector
    
        try:
>           await connected
E           asyncpg.exceptions.InvalidPasswordError: password authentication failed for user "postgres"

C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connect_utils.py:876: InvalidPasswordError
_____________ TestWaitTimeEndpoints.test_get_all_wait_times_empty _____________

self = <tests.test_app.TestWaitTimeEndpoints object at 0x000001A88DAF2A90>
test_client = <httpx.AsyncClient object at 0x000001A88FD24310>

    @pytest.mark.asyncio
    async def test_get_all_wait_times_empty(self, test_client):
        """Test getting all wait times when none exist"""
>       response = await test_client.get("/api/waittime/all")

tests\test_app.py:96: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1757: in get
    return await self.request(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1530: in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1617: in send
    response = await self._send_handling_auth(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1645: in _send_handling_auth
    response = await self._send_handling_redirects(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1682: in _send_handling_redirects
    response = await self._send_single_request(request)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1719: in _send_single_request
    response = await transport.handle_async_request(request)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_transports\asgi.py:162: in handle_async_request
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\applications.py:1106: in __call__
    await super().__call__(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\applications.py:122: in __call__
    await self.middleware_stack(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:184: in __call__
    raise exc
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:162: in __call__
    await self.app(scope, receive, _send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\cors.py:83: in __call__
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:79: in __call__
    raise exc
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:68: in __call__
    await self.app(scope, receive, sender)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:20: in __call__
    raise e
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:17: in __call__
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:718: in __call__
    await route.handle(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:276: in handle
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:66: in app
    response = await func(request)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:274: in app
    raw_response = await run_endpoint_function(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:191: in run_endpoint_function
    return await dependant.call(**values)
app.py:165: in get_all_wait_times
    wait_times = await repo.get_all_wait_times(poi_type=poi_type)
db\repositories.py:187: in get_all_wait_times
    result = await self.session.execute(query)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\ext\asyncio\session.py:455: in execute
    result = await greenlet_spawn(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py:190: in greenlet_spawn
    result = context.throw(*sys.exc_info())
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2308: in execute
    return self._execute_internal(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2180: in _execute_internal
    conn = self._connection_for_bind(bind)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2047: in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
<string>:2: in _connection_for_bind
    ???
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state_changes.py:139: in _go
    ret_value = fn(self, *arg, **kw)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:1143: in _connection_for_bind
    conn = bind.connect()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:3268: in connect
    return self._connection_cls(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:145: in __init__
    self._dbapi_connection = engine.raw_connection()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:3292: in raw_connection
    return self.pool.connect()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:452: in connect
    return _ConnectionFairy._checkout(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:1269: in _checkout
    fairy = _ConnectionRecord.checkout(pool)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:716: in checkout
    rec = pool._do_get()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\impl.py:169: in _do_get
    with util.safe_reraise():
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:146: in __exit__
    raise exc_value.with_traceback(exc_tb)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\impl.py:167: in _do_get
    return self._create_connection()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:393: in _create_connection
    return _ConnectionRecord(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:678: in __init__
    self.__connect()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:902: in __connect
    with util.safe_reraise():
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:146: in __exit__
    raise exc_value.with_traceback(exc_tb)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:898: in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\create.py:637: in connect
    return dialect.connect(*cargs, **cparams)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\default.py:616: in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py:936: in connect
    await_only(creator_fn(*arg, **kw)),
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py:125: in await_only
    return current.driver.switch(awaitable)  # type: ignore[no-any-return]
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py:185: in greenlet_spawn
    value = await result
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connection.py:2329: in connect
    return await connect_utils._connect(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connect_utils.py:991: in _connect
    conn = await _connect_addr(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connect_utils.py:828: in _connect_addr
    return await __connect_addr(params, True, *args)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

params = ConnectionParameters(user='postgres', password='postgres', database='stadium_waittime', ssl=<ssl.SSLContext object at ...slmode=<SSLMode.prefer: 2>, direct_tls=False, server_settings=None, target_session_attrs=<SessionAttribute.any: 'any'>)
retry = True, addr = ('localhost', 5432)
loop = <ProactorEventLoop running=False closed=False debug=False>
config = ConnectionConfiguration(command_timeout=None, statement_cache_size=100, max_cached_statement_lifetime=300, max_cacheable_statement_size=15360)
connection_class = <class 'asyncpg.connection.Connection'>
record_class = <class 'asyncpg.Record'>
params_input = ConnectionParameters(user='postgres', password='postgres', database='stadium_waittime', ssl=<ssl.SSLContext object at ...slmode=<SSLMode.prefer: 2>, direct_tls=False, server_settings=None, target_session_attrs=<SessionAttribute.any: 'any'>)

    async def __connect_addr(
        params,
        retry,
        addr,
        loop,
        config,
        connection_class,
        record_class,
        params_input,
    ):
        connected = _create_future(loop)
    
        proto_factory = lambda: protocol.Protocol(
            addr, connected, params, record_class, loop)
    
        if isinstance(addr, str):
            # UNIX socket
            connector = loop.create_unix_connection(proto_factory, addr)
    
        elif params.ssl and params.direct_tls:
            # if ssl and direct_tls are given, skip STARTTLS and perform direct
            # SSL connection
            connector = loop.create_connection(
                proto_factory, *addr, ssl=params.ssl
            )
    
        elif params.ssl:
            connector = _create_ssl_connection(
                proto_factory, *addr, loop=loop, ssl_context=params.ssl,
                ssl_is_advisory=params.sslmode == SSLMode.prefer)
        else:
            connector = loop.create_connection(proto_factory, *addr)
    
        tr, pr = await connector
    
        try:
>           await connected
E           asyncpg.exceptions.InvalidPasswordError: password authentication failed for user "postgres"

C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connect_utils.py:876: InvalidPasswordError
_____________________ TestPOIEndpoints.test_get_all_pois ______________________

self = <tests.test_app.TestPOIEndpoints object at 0x000001A88DAF3290>
test_client = <httpx.AsyncClient object at 0x000001A88F43F790>
test_db_session = <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x000001A88F43D450>
seed_pois = [{'id': 'WC-Norte-L0-1', 'name': 'Restrooms North Level 0 #1', 'num_servers': 8, 'poi_type': 'restroom', ...}, {'id': ...ype': 'restroom', ...}, {'id': 'Food-Sul-1', 'name': 'Food Court South #1', 'num_servers': 4, 'poi_type': 'food', ...}]

    @pytest.mark.asyncio
    async def test_get_all_pois(self, test_client, test_db_session, seed_pois):
        """Test getting all POIs"""
>       response = await test_client.get("/api/pois")

tests\test_app.py:111: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1757: in get
    return await self.request(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1530: in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1617: in send
    response = await self._send_handling_auth(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1645: in _send_handling_auth
    response = await self._send_handling_redirects(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1682: in _send_handling_redirects
    response = await self._send_single_request(request)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1719: in _send_single_request
    response = await transport.handle_async_request(request)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_transports\asgi.py:162: in handle_async_request
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\applications.py:1106: in __call__
    await super().__call__(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\applications.py:122: in __call__
    await self.middleware_stack(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:184: in __call__
    raise exc
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:162: in __call__
    await self.app(scope, receive, _send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\cors.py:83: in __call__
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:79: in __call__
    raise exc
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:68: in __call__
    await self.app(scope, receive, sender)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:20: in __call__
    raise e
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:17: in __call__
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:718: in __call__
    await route.handle(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:276: in handle
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:66: in app
    response = await func(request)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:274: in app
    raw_response = await run_endpoint_function(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:191: in run_endpoint_function
    return await dependant.call(**values)
app.py:182: in get_pois
    pois = await repo.get_all_pois(poi_type=poi_type)
db\repositories.py:57: in get_all_pois
    result = await self.session.execute(query)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\ext\asyncio\session.py:455: in execute
    result = await greenlet_spawn(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py:190: in greenlet_spawn
    result = context.throw(*sys.exc_info())
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2308: in execute
    return self._execute_internal(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2180: in _execute_internal
    conn = self._connection_for_bind(bind)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2047: in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
<string>:2: in _connection_for_bind
    ???
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state_changes.py:139: in _go
    ret_value = fn(self, *arg, **kw)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:1143: in _connection_for_bind
    conn = bind.connect()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:3268: in connect
    return self._connection_cls(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:145: in __init__
    self._dbapi_connection = engine.raw_connection()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:3292: in raw_connection
    return self.pool.connect()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:452: in connect
    return _ConnectionFairy._checkout(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:1269: in _checkout
    fairy = _ConnectionRecord.checkout(pool)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:716: in checkout
    rec = pool._do_get()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\impl.py:169: in _do_get
    with util.safe_reraise():
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:146: in __exit__
    raise exc_value.with_traceback(exc_tb)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\impl.py:167: in _do_get
    return self._create_connection()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:393: in _create_connection
    return _ConnectionRecord(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:678: in __init__
    self.__connect()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:902: in __connect
    with util.safe_reraise():
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:146: in __exit__
    raise exc_value.with_traceback(exc_tb)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:898: in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\create.py:637: in connect
    return dialect.connect(*cargs, **cparams)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\default.py:616: in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py:936: in connect
    await_only(creator_fn(*arg, **kw)),
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py:125: in await_only
    return current.driver.switch(awaitable)  # type: ignore[no-any-return]
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py:185: in greenlet_spawn
    value = await result
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connection.py:2329: in connect
    return await connect_utils._connect(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connect_utils.py:991: in _connect
    conn = await _connect_addr(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connect_utils.py:828: in _connect_addr
    return await __connect_addr(params, True, *args)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

params = ConnectionParameters(user='postgres', password='postgres', database='stadium_waittime', ssl=<ssl.SSLContext object at ...slmode=<SSLMode.prefer: 2>, direct_tls=False, server_settings=None, target_session_attrs=<SessionAttribute.any: 'any'>)
retry = True, addr = ('localhost', 5432)
loop = <ProactorEventLoop running=False closed=False debug=False>
config = ConnectionConfiguration(command_timeout=None, statement_cache_size=100, max_cached_statement_lifetime=300, max_cacheable_statement_size=15360)
connection_class = <class 'asyncpg.connection.Connection'>
record_class = <class 'asyncpg.Record'>
params_input = ConnectionParameters(user='postgres', password='postgres', database='stadium_waittime', ssl=<ssl.SSLContext object at ...slmode=<SSLMode.prefer: 2>, direct_tls=False, server_settings=None, target_session_attrs=<SessionAttribute.any: 'any'>)

    async def __connect_addr(
        params,
        retry,
        addr,
        loop,
        config,
        connection_class,
        record_class,
        params_input,
    ):
        connected = _create_future(loop)
    
        proto_factory = lambda: protocol.Protocol(
            addr, connected, params, record_class, loop)
    
        if isinstance(addr, str):
            # UNIX socket
            connector = loop.create_unix_connection(proto_factory, addr)
    
        elif params.ssl and params.direct_tls:
            # if ssl and direct_tls are given, skip STARTTLS and perform direct
            # SSL connection
            connector = loop.create_connection(
                proto_factory, *addr, ssl=params.ssl
            )
    
        elif params.ssl:
            connector = _create_ssl_connection(
                proto_factory, *addr, loop=loop, ssl_context=params.ssl,
                ssl_is_advisory=params.sslmode == SSLMode.prefer)
        else:
            connector = loop.create_connection(proto_factory, *addr)
    
        tr, pr = await connector
    
        try:
>           await connected
E           asyncpg.exceptions.InvalidPasswordError: password authentication failed for user "postgres"

C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connect_utils.py:876: InvalidPasswordError
_______________ TestPOIEndpoints.test_get_pois_filtered_by_type _______________

self = <tests.test_app.TestPOIEndpoints object at 0x000001A88DAF3990>
test_client = <httpx.AsyncClient object at 0x000001A89097F4D0>
test_db_session = <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x000001A89097C810>
seed_pois = [{'id': 'WC-Norte-L0-1', 'name': 'Restrooms North Level 0 #1', 'num_servers': 8, 'poi_type': 'restroom', ...}, {'id': ...ype': 'restroom', ...}, {'id': 'Food-Sul-1', 'name': 'Food Court South #1', 'num_servers': 4, 'poi_type': 'food', ...}]

    @pytest.mark.asyncio
    async def test_get_pois_filtered_by_type(self, test_client, test_db_session, seed_pois):
        """Test getting POIs filtered by type"""
>       response = await test_client.get("/api/pois?poi_type=food")

tests\test_app.py:130: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1757: in get
    return await self.request(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1530: in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1617: in send
    response = await self._send_handling_auth(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1645: in _send_handling_auth
    response = await self._send_handling_redirects(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1682: in _send_handling_redirects
    response = await self._send_single_request(request)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1719: in _send_single_request
    response = await transport.handle_async_request(request)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_transports\asgi.py:162: in handle_async_request
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\applications.py:1106: in __call__
    await super().__call__(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\applications.py:122: in __call__
    await self.middleware_stack(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:184: in __call__
    raise exc
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:162: in __call__
    await self.app(scope, receive, _send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\cors.py:83: in __call__
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:79: in __call__
    raise exc
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:68: in __call__
    await self.app(scope, receive, sender)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:20: in __call__
    raise e
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:17: in __call__
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:718: in __call__
    await route.handle(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:276: in handle
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:66: in app
    response = await func(request)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:274: in app
    raw_response = await run_endpoint_function(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:191: in run_endpoint_function
    return await dependant.call(**values)
app.py:182: in get_pois
    pois = await repo.get_all_pois(poi_type=poi_type)
db\repositories.py:57: in get_all_pois
    result = await self.session.execute(query)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\ext\asyncio\session.py:455: in execute
    result = await greenlet_spawn(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py:190: in greenlet_spawn
    result = context.throw(*sys.exc_info())
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2308: in execute
    return self._execute_internal(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2180: in _execute_internal
    conn = self._connection_for_bind(bind)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2047: in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
<string>:2: in _connection_for_bind
    ???
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state_changes.py:139: in _go
    ret_value = fn(self, *arg, **kw)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:1143: in _connection_for_bind
    conn = bind.connect()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:3268: in connect
    return self._connection_cls(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:145: in __init__
    self._dbapi_connection = engine.raw_connection()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:3292: in raw_connection
    return self.pool.connect()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:452: in connect
    return _ConnectionFairy._checkout(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:1269: in _checkout
    fairy = _ConnectionRecord.checkout(pool)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:716: in checkout
    rec = pool._do_get()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\impl.py:169: in _do_get
    with util.safe_reraise():
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:146: in __exit__
    raise exc_value.with_traceback(exc_tb)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\impl.py:167: in _do_get
    return self._create_connection()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:393: in _create_connection
    return _ConnectionRecord(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:678: in __init__
    self.__connect()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:902: in __connect
    with util.safe_reraise():
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:146: in __exit__
    raise exc_value.with_traceback(exc_tb)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:898: in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\create.py:637: in connect
    return dialect.connect(*cargs, **cparams)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\default.py:616: in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py:936: in connect
    await_only(creator_fn(*arg, **kw)),
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py:125: in await_only
    return current.driver.switch(awaitable)  # type: ignore[no-any-return]
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py:185: in greenlet_spawn
    value = await result
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connection.py:2329: in connect
    return await connect_utils._connect(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connect_utils.py:991: in _connect
    conn = await _connect_addr(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connect_utils.py:828: in _connect_addr
    return await __connect_addr(params, True, *args)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

params = ConnectionParameters(user='postgres', password='postgres', database='stadium_waittime', ssl=<ssl.SSLContext object at ...slmode=<SSLMode.prefer: 2>, direct_tls=False, server_settings=None, target_session_attrs=<SessionAttribute.any: 'any'>)
retry = True, addr = ('localhost', 5432)
loop = <ProactorEventLoop running=False closed=False debug=False>
config = ConnectionConfiguration(command_timeout=None, statement_cache_size=100, max_cached_statement_lifetime=300, max_cacheable_statement_size=15360)
connection_class = <class 'asyncpg.connection.Connection'>
record_class = <class 'asyncpg.Record'>
params_input = ConnectionParameters(user='postgres', password='postgres', database='stadium_waittime', ssl=<ssl.SSLContext object at ...slmode=<SSLMode.prefer: 2>, direct_tls=False, server_settings=None, target_session_attrs=<SessionAttribute.any: 'any'>)

    async def __connect_addr(
        params,
        retry,
        addr,
        loop,
        config,
        connection_class,
        record_class,
        params_input,
    ):
        connected = _create_future(loop)
    
        proto_factory = lambda: protocol.Protocol(
            addr, connected, params, record_class, loop)
    
        if isinstance(addr, str):
            # UNIX socket
            connector = loop.create_unix_connection(proto_factory, addr)
    
        elif params.ssl and params.direct_tls:
            # if ssl and direct_tls are given, skip STARTTLS and perform direct
            # SSL connection
            connector = loop.create_connection(
                proto_factory, *addr, ssl=params.ssl
            )
    
        elif params.ssl:
            connector = _create_ssl_connection(
                proto_factory, *addr, loop=loop, ssl_context=params.ssl,
                ssl_is_advisory=params.sslmode == SSLMode.prefer)
        else:
            connector = loop.create_connection(proto_factory, *addr)
    
        tr, pr = await connector
    
        try:
>           await connected
E           asyncpg.exceptions.InvalidPasswordError: password authentication failed for user "postgres"

C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connect_utils.py:876: InvalidPasswordError
____________________ TestPOIEndpoints.test_get_pois_empty _____________________

self = <tests.test_app.TestPOIEndpoints object at 0x000001A88DAF8190>
test_client = <httpx.AsyncClient object at 0x000001A890BE0AD0>

    @pytest.mark.asyncio
    async def test_get_pois_empty(self, test_client):
        """Test getting POIs when database is empty"""
>       response = await test_client.get("/api/pois")

tests\test_app.py:143: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1757: in get
    return await self.request(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1530: in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1617: in send
    response = await self._send_handling_auth(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1645: in _send_handling_auth
    response = await self._send_handling_redirects(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1682: in _send_handling_redirects
    response = await self._send_single_request(request)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1719: in _send_single_request
    response = await transport.handle_async_request(request)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_transports\asgi.py:162: in handle_async_request
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\applications.py:1106: in __call__
    await super().__call__(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\applications.py:122: in __call__
    await self.middleware_stack(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:184: in __call__
    raise exc
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:162: in __call__
    await self.app(scope, receive, _send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\cors.py:83: in __call__
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:79: in __call__
    raise exc
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:68: in __call__
    await self.app(scope, receive, sender)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:20: in __call__
    raise e
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:17: in __call__
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:718: in __call__
    await route.handle(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:276: in handle
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:66: in app
    response = await func(request)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:274: in app
    raw_response = await run_endpoint_function(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:191: in run_endpoint_function
    return await dependant.call(**values)
app.py:182: in get_pois
    pois = await repo.get_all_pois(poi_type=poi_type)
db\repositories.py:57: in get_all_pois
    result = await self.session.execute(query)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\ext\asyncio\session.py:455: in execute
    result = await greenlet_spawn(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py:190: in greenlet_spawn
    result = context.throw(*sys.exc_info())
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2308: in execute
    return self._execute_internal(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2180: in _execute_internal
    conn = self._connection_for_bind(bind)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2047: in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
<string>:2: in _connection_for_bind
    ???
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state_changes.py:139: in _go
    ret_value = fn(self, *arg, **kw)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:1143: in _connection_for_bind
    conn = bind.connect()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:3268: in connect
    return self._connection_cls(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:145: in __init__
    self._dbapi_connection = engine.raw_connection()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:3292: in raw_connection
    return self.pool.connect()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:452: in connect
    return _ConnectionFairy._checkout(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:1269: in _checkout
    fairy = _ConnectionRecord.checkout(pool)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:716: in checkout
    rec = pool._do_get()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\impl.py:169: in _do_get
    with util.safe_reraise():
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:146: in __exit__
    raise exc_value.with_traceback(exc_tb)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\impl.py:167: in _do_get
    return self._create_connection()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:393: in _create_connection
    return _ConnectionRecord(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:678: in __init__
    self.__connect()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:902: in __connect
    with util.safe_reraise():
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:146: in __exit__
    raise exc_value.with_traceback(exc_tb)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:898: in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\create.py:637: in connect
    return dialect.connect(*cargs, **cparams)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\default.py:616: in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py:936: in connect
    await_only(creator_fn(*arg, **kw)),
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py:125: in await_only
    return current.driver.switch(awaitable)  # type: ignore[no-any-return]
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py:185: in greenlet_spawn
    value = await result
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connection.py:2329: in connect
    return await connect_utils._connect(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connect_utils.py:991: in _connect
    conn = await _connect_addr(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connect_utils.py:828: in _connect_addr
    return await __connect_addr(params, True, *args)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

params = ConnectionParameters(user='postgres', password='postgres', database='stadium_waittime', ssl=<ssl.SSLContext object at ...slmode=<SSLMode.prefer: 2>, direct_tls=False, server_settings=None, target_session_attrs=<SessionAttribute.any: 'any'>)
retry = True, addr = ('localhost', 5432)
loop = <ProactorEventLoop running=False closed=False debug=False>
config = ConnectionConfiguration(command_timeout=None, statement_cache_size=100, max_cached_statement_lifetime=300, max_cacheable_statement_size=15360)
connection_class = <class 'asyncpg.connection.Connection'>
record_class = <class 'asyncpg.Record'>
params_input = ConnectionParameters(user='postgres', password='postgres', database='stadium_waittime', ssl=<ssl.SSLContext object at ...slmode=<SSLMode.prefer: 2>, direct_tls=False, server_settings=None, target_session_attrs=<SessionAttribute.any: 'any'>)

    async def __connect_addr(
        params,
        retry,
        addr,
        loop,
        config,
        connection_class,
        record_class,
        params_input,
    ):
        connected = _create_future(loop)
    
        proto_factory = lambda: protocol.Protocol(
            addr, connected, params, record_class, loop)
    
        if isinstance(addr, str):
            # UNIX socket
            connector = loop.create_unix_connection(proto_factory, addr)
    
        elif params.ssl and params.direct_tls:
            # if ssl and direct_tls are given, skip STARTTLS and perform direct
            # SSL connection
            connector = loop.create_connection(
                proto_factory, *addr, ssl=params.ssl
            )
    
        elif params.ssl:
            connector = _create_ssl_connection(
                proto_factory, *addr, loop=loop, ssl_context=params.ssl,
                ssl_is_advisory=params.sslmode == SSLMode.prefer)
        else:
            connector = loop.create_connection(proto_factory, *addr)
    
        tr, pr = await connector
    
        try:
>           await connected
E           asyncpg.exceptions.InvalidPasswordError: password authentication failed for user "postgres"

C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connect_utils.py:876: InvalidPasswordError
_________________ TestPOIEndpoints.test_get_poi_by_id_success _________________

self = <tests.test_app.TestPOIEndpoints object at 0x000001A88DAF8990>
test_client = <httpx.AsyncClient object at 0x000001A89043E0D0>
test_db_session = <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x000001A89043CD10>
seed_pois = [{'id': 'WC-Norte-L0-1', 'name': 'Restrooms North Level 0 #1', 'num_servers': 8, 'poi_type': 'restroom', ...}, {'id': ...ype': 'restroom', ...}, {'id': 'Food-Sul-1', 'name': 'Food Court South #1', 'num_servers': 4, 'poi_type': 'food', ...}]

    @pytest.mark.asyncio
    async def test_get_poi_by_id_success(self, test_client, test_db_session, seed_pois):
        """Test getting a specific POI by ID"""
>       response = await test_client.get("/api/poi/WC-Norte-L0-1")

tests\test_app.py:154: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1757: in get
    return await self.request(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1530: in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1617: in send
    response = await self._send_handling_auth(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1645: in _send_handling_auth
    response = await self._send_handling_redirects(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1682: in _send_handling_redirects
    response = await self._send_single_request(request)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1719: in _send_single_request
    response = await transport.handle_async_request(request)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_transports\asgi.py:162: in handle_async_request
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\applications.py:1106: in __call__
    await super().__call__(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\applications.py:122: in __call__
    await self.middleware_stack(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:184: in __call__
    raise exc
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:162: in __call__
    await self.app(scope, receive, _send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\cors.py:83: in __call__
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:79: in __call__
    raise exc
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:68: in __call__
    await self.app(scope, receive, sender)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:20: in __call__
    raise e
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:17: in __call__
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:718: in __call__
    await route.handle(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:276: in handle
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:66: in app
    response = await func(request)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:274: in app
    raw_response = await run_endpoint_function(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:191: in run_endpoint_function
    return await dependant.call(**values)
app.py:197: in get_poi_details
    poi = await repo.get_poi_by_id(poi_id)
db\repositories.py:36: in get_poi_by_id
    result = await self.session.execute(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\ext\asyncio\session.py:455: in execute
    result = await greenlet_spawn(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py:190: in greenlet_spawn
    result = context.throw(*sys.exc_info())
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2308: in execute
    return self._execute_internal(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2180: in _execute_internal
    conn = self._connection_for_bind(bind)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2047: in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
<string>:2: in _connection_for_bind
    ???
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state_changes.py:139: in _go
    ret_value = fn(self, *arg, **kw)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:1143: in _connection_for_bind
    conn = bind.connect()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:3268: in connect
    return self._connection_cls(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:145: in __init__
    self._dbapi_connection = engine.raw_connection()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:3292: in raw_connection
    return self.pool.connect()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:452: in connect
    return _ConnectionFairy._checkout(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:1269: in _checkout
    fairy = _ConnectionRecord.checkout(pool)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:716: in checkout
    rec = pool._do_get()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\impl.py:169: in _do_get
    with util.safe_reraise():
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:146: in __exit__
    raise exc_value.with_traceback(exc_tb)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\impl.py:167: in _do_get
    return self._create_connection()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:393: in _create_connection
    return _ConnectionRecord(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:678: in __init__
    self.__connect()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:902: in __connect
    with util.safe_reraise():
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:146: in __exit__
    raise exc_value.with_traceback(exc_tb)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:898: in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\create.py:637: in connect
    return dialect.connect(*cargs, **cparams)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\default.py:616: in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py:936: in connect
    await_only(creator_fn(*arg, **kw)),
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py:125: in await_only
    return current.driver.switch(awaitable)  # type: ignore[no-any-return]
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py:185: in greenlet_spawn
    value = await result
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connection.py:2329: in connect
    return await connect_utils._connect(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connect_utils.py:991: in _connect
    conn = await _connect_addr(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connect_utils.py:828: in _connect_addr
    return await __connect_addr(params, True, *args)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

params = ConnectionParameters(user='postgres', password='postgres', database='stadium_waittime', ssl=<ssl.SSLContext object at ...slmode=<SSLMode.prefer: 2>, direct_tls=False, server_settings=None, target_session_attrs=<SessionAttribute.any: 'any'>)
retry = True, addr = ('localhost', 5432)
loop = <ProactorEventLoop running=False closed=False debug=False>
config = ConnectionConfiguration(command_timeout=None, statement_cache_size=100, max_cached_statement_lifetime=300, max_cacheable_statement_size=15360)
connection_class = <class 'asyncpg.connection.Connection'>
record_class = <class 'asyncpg.Record'>
params_input = ConnectionParameters(user='postgres', password='postgres', database='stadium_waittime', ssl=<ssl.SSLContext object at ...slmode=<SSLMode.prefer: 2>, direct_tls=False, server_settings=None, target_session_attrs=<SessionAttribute.any: 'any'>)

    async def __connect_addr(
        params,
        retry,
        addr,
        loop,
        config,
        connection_class,
        record_class,
        params_input,
    ):
        connected = _create_future(loop)
    
        proto_factory = lambda: protocol.Protocol(
            addr, connected, params, record_class, loop)
    
        if isinstance(addr, str):
            # UNIX socket
            connector = loop.create_unix_connection(proto_factory, addr)
    
        elif params.ssl and params.direct_tls:
            # if ssl and direct_tls are given, skip STARTTLS and perform direct
            # SSL connection
            connector = loop.create_connection(
                proto_factory, *addr, ssl=params.ssl
            )
    
        elif params.ssl:
            connector = _create_ssl_connection(
                proto_factory, *addr, loop=loop, ssl_context=params.ssl,
                ssl_is_advisory=params.sslmode == SSLMode.prefer)
        else:
            connector = loop.create_connection(proto_factory, *addr)
    
        tr, pr = await connector
    
        try:
>           await connected
E           asyncpg.exceptions.InvalidPasswordError: password authentication failed for user "postgres"

C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connect_utils.py:876: InvalidPasswordError
________________ TestPOIEndpoints.test_get_poi_by_id_not_found ________________

self = <tests.test_app.TestPOIEndpoints object at 0x000001A88DAF9150>
test_client = <httpx.AsyncClient object at 0x000001A8909894D0>

    @pytest.mark.asyncio
    async def test_get_poi_by_id_not_found(self, test_client):
        """Test getting non-existent POI returns 404"""
>       response = await test_client.get("/api/poi/NonExistent-POI")

tests\test_app.py:168: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1757: in get
    return await self.request(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1530: in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1617: in send
    response = await self._send_handling_auth(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1645: in _send_handling_auth
    response = await self._send_handling_redirects(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1682: in _send_handling_redirects
    response = await self._send_single_request(request)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1719: in _send_single_request
    response = await transport.handle_async_request(request)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_transports\asgi.py:162: in handle_async_request
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\applications.py:1106: in __call__
    await super().__call__(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\applications.py:122: in __call__
    await self.middleware_stack(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:184: in __call__
    raise exc
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:162: in __call__
    await self.app(scope, receive, _send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\cors.py:83: in __call__
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:79: in __call__
    raise exc
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:68: in __call__
    await self.app(scope, receive, sender)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:20: in __call__
    raise e
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:17: in __call__
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:718: in __call__
    await route.handle(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:276: in handle
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:66: in app
    response = await func(request)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:274: in app
    raw_response = await run_endpoint_function(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:191: in run_endpoint_function
    return await dependant.call(**values)
app.py:197: in get_poi_details
    poi = await repo.get_poi_by_id(poi_id)
db\repositories.py:36: in get_poi_by_id
    result = await self.session.execute(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\ext\asyncio\session.py:455: in execute
    result = await greenlet_spawn(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py:190: in greenlet_spawn
    result = context.throw(*sys.exc_info())
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2308: in execute
    return self._execute_internal(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2180: in _execute_internal
    conn = self._connection_for_bind(bind)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2047: in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
<string>:2: in _connection_for_bind
    ???
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state_changes.py:139: in _go
    ret_value = fn(self, *arg, **kw)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:1143: in _connection_for_bind
    conn = bind.connect()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:3268: in connect
    return self._connection_cls(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:145: in __init__
    self._dbapi_connection = engine.raw_connection()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:3292: in raw_connection
    return self.pool.connect()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:452: in connect
    return _ConnectionFairy._checkout(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:1269: in _checkout
    fairy = _ConnectionRecord.checkout(pool)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:716: in checkout
    rec = pool._do_get()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\impl.py:169: in _do_get
    with util.safe_reraise():
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:146: in __exit__
    raise exc_value.with_traceback(exc_tb)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\impl.py:167: in _do_get
    return self._create_connection()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:393: in _create_connection
    return _ConnectionRecord(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:678: in __init__
    self.__connect()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:902: in __connect
    with util.safe_reraise():
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:146: in __exit__
    raise exc_value.with_traceback(exc_tb)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:898: in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\create.py:637: in connect
    return dialect.connect(*cargs, **cparams)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\default.py:616: in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py:936: in connect
    await_only(creator_fn(*arg, **kw)),
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py:125: in await_only
    return current.driver.switch(awaitable)  # type: ignore[no-any-return]
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py:185: in greenlet_spawn
    value = await result
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connection.py:2329: in connect
    return await connect_utils._connect(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connect_utils.py:991: in _connect
    conn = await _connect_addr(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connect_utils.py:828: in _connect_addr
    return await __connect_addr(params, True, *args)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

params = ConnectionParameters(user='postgres', password='postgres', database='stadium_waittime', ssl=<ssl.SSLContext object at ...slmode=<SSLMode.prefer: 2>, direct_tls=False, server_settings=None, target_session_attrs=<SessionAttribute.any: 'any'>)
retry = True, addr = ('localhost', 5432)
loop = <ProactorEventLoop running=False closed=False debug=False>
config = ConnectionConfiguration(command_timeout=None, statement_cache_size=100, max_cached_statement_lifetime=300, max_cacheable_statement_size=15360)
connection_class = <class 'asyncpg.connection.Connection'>
record_class = <class 'asyncpg.Record'>
params_input = ConnectionParameters(user='postgres', password='postgres', database='stadium_waittime', ssl=<ssl.SSLContext object at ...slmode=<SSLMode.prefer: 2>, direct_tls=False, server_settings=None, target_session_attrs=<SessionAttribute.any: 'any'>)

    async def __connect_addr(
        params,
        retry,
        addr,
        loop,
        config,
        connection_class,
        record_class,
        params_input,
    ):
        connected = _create_future(loop)
    
        proto_factory = lambda: protocol.Protocol(
            addr, connected, params, record_class, loop)
    
        if isinstance(addr, str):
            # UNIX socket
            connector = loop.create_unix_connection(proto_factory, addr)
    
        elif params.ssl and params.direct_tls:
            # if ssl and direct_tls are given, skip STARTTLS and perform direct
            # SSL connection
            connector = loop.create_connection(
                proto_factory, *addr, ssl=params.ssl
            )
    
        elif params.ssl:
            connector = _create_ssl_connection(
                proto_factory, *addr, loop=loop, ssl_context=params.ssl,
                ssl_is_advisory=params.sslmode == SSLMode.prefer)
        else:
            connector = loop.create_connection(proto_factory, *addr)
    
        tr, pr = await connector
    
        try:
>           await connected
E           asyncpg.exceptions.InvalidPasswordError: password authentication failed for user "postgres"

C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connect_utils.py:876: InvalidPasswordError
________________ TestDebugEndpoints.test_get_queue_state_debug ________________

self = <tests.test_app.TestDebugEndpoints object at 0x000001A88DAF9910>
test_client = <httpx.AsyncClient object at 0x000001A890058750>
test_db_session = <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x000001A890058D90>
seed_queue_states = [{'arrival_rate': 2.5, 'confidence_lower': 4.0, 'confidence_upper': 6.5, 'current_wait_minutes': 5.2, ...}, {'arrival_... 3.1, ...}, {'arrival_rate': 3.2, 'confidence_lower': 7.0, 'confidence_upper': 10.5, 'current_wait_minutes': 8.7, ...}]

    @pytest.mark.asyncio
    async def test_get_queue_state_debug(self, test_client, test_db_session, seed_queue_states):
        """Test getting raw queue state for debugging"""
>       response = await test_client.get("/debug/queue-state/WC-Norte-L0-1")

tests\test_app.py:180: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1757: in get
    return await self.request(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1530: in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1617: in send
    response = await self._send_handling_auth(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1645: in _send_handling_auth
    response = await self._send_handling_redirects(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1682: in _send_handling_redirects
    response = await self._send_single_request(request)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1719: in _send_single_request
    response = await transport.handle_async_request(request)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_transports\asgi.py:162: in handle_async_request
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\applications.py:1106: in __call__
    await super().__call__(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\applications.py:122: in __call__
    await self.middleware_stack(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:184: in __call__
    raise exc
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:162: in __call__
    await self.app(scope, receive, _send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\cors.py:83: in __call__
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:79: in __call__
    raise exc
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:68: in __call__
    await self.app(scope, receive, sender)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:20: in __call__
    raise e
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:17: in __call__
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:718: in __call__
    await route.handle(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:276: in handle
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:66: in app
    response = await func(request)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:274: in app
    raw_response = await run_endpoint_function(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:191: in run_endpoint_function
    return await dependant.call(**values)
app.py:217: in get_queue_state_debug
    state = await repo.get_queue_state_raw(poi_id)
db\repositories.py:204: in get_queue_state_raw
    result = await self.session.execute(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\ext\asyncio\session.py:455: in execute
    result = await greenlet_spawn(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py:190: in greenlet_spawn
    result = context.throw(*sys.exc_info())
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2308: in execute
    return self._execute_internal(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2180: in _execute_internal
    conn = self._connection_for_bind(bind)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2047: in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
<string>:2: in _connection_for_bind
    ???
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state_changes.py:139: in _go
    ret_value = fn(self, *arg, **kw)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:1143: in _connection_for_bind
    conn = bind.connect()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:3268: in connect
    return self._connection_cls(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:145: in __init__
    self._dbapi_connection = engine.raw_connection()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:3292: in raw_connection
    return self.pool.connect()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:452: in connect
    return _ConnectionFairy._checkout(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:1269: in _checkout
    fairy = _ConnectionRecord.checkout(pool)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:716: in checkout
    rec = pool._do_get()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\impl.py:169: in _do_get
    with util.safe_reraise():
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:146: in __exit__
    raise exc_value.with_traceback(exc_tb)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\impl.py:167: in _do_get
    return self._create_connection()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:393: in _create_connection
    return _ConnectionRecord(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:678: in __init__
    self.__connect()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:902: in __connect
    with util.safe_reraise():
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:146: in __exit__
    raise exc_value.with_traceback(exc_tb)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:898: in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\create.py:637: in connect
    return dialect.connect(*cargs, **cparams)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\default.py:616: in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py:936: in connect
    await_only(creator_fn(*arg, **kw)),
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py:125: in await_only
    return current.driver.switch(awaitable)  # type: ignore[no-any-return]
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py:185: in greenlet_spawn
    value = await result
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connection.py:2329: in connect
    return await connect_utils._connect(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connect_utils.py:991: in _connect
    conn = await _connect_addr(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connect_utils.py:828: in _connect_addr
    return await __connect_addr(params, True, *args)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

params = ConnectionParameters(user='postgres', password='postgres', database='stadium_waittime', ssl=<ssl.SSLContext object at ...slmode=<SSLMode.prefer: 2>, direct_tls=False, server_settings=None, target_session_attrs=<SessionAttribute.any: 'any'>)
retry = True, addr = ('localhost', 5432)
loop = <ProactorEventLoop running=False closed=False debug=False>
config = ConnectionConfiguration(command_timeout=None, statement_cache_size=100, max_cached_statement_lifetime=300, max_cacheable_statement_size=15360)
connection_class = <class 'asyncpg.connection.Connection'>
record_class = <class 'asyncpg.Record'>
params_input = ConnectionParameters(user='postgres', password='postgres', database='stadium_waittime', ssl=<ssl.SSLContext object at ...slmode=<SSLMode.prefer: 2>, direct_tls=False, server_settings=None, target_session_attrs=<SessionAttribute.any: 'any'>)

    async def __connect_addr(
        params,
        retry,
        addr,
        loop,
        config,
        connection_class,
        record_class,
        params_input,
    ):
        connected = _create_future(loop)
    
        proto_factory = lambda: protocol.Protocol(
            addr, connected, params, record_class, loop)
    
        if isinstance(addr, str):
            # UNIX socket
            connector = loop.create_unix_connection(proto_factory, addr)
    
        elif params.ssl and params.direct_tls:
            # if ssl and direct_tls are given, skip STARTTLS and perform direct
            # SSL connection
            connector = loop.create_connection(
                proto_factory, *addr, ssl=params.ssl
            )
    
        elif params.ssl:
            connector = _create_ssl_connection(
                proto_factory, *addr, loop=loop, ssl_context=params.ssl,
                ssl_is_advisory=params.sslmode == SSLMode.prefer)
        else:
            connector = loop.create_connection(proto_factory, *addr)
    
        tr, pr = await connector
    
        try:
>           await connected
E           asyncpg.exceptions.InvalidPasswordError: password authentication failed for user "postgres"

C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connect_utils.py:876: InvalidPasswordError
___________ TestDebugEndpoints.test_get_queue_state_debug_not_found ___________

self = <tests.test_app.TestDebugEndpoints object at 0x000001A88DAFA010>
test_client = <httpx.AsyncClient object at 0x000001A88FCA4BD0>

    @pytest.mark.asyncio
    async def test_get_queue_state_debug_not_found(self, test_client):
        """Test debug queue state for non-existent POI returns 404"""
>       response = await test_client.get("/debug/queue-state/NonExistent-POI")

tests\test_app.py:193: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1757: in get
    return await self.request(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1530: in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1617: in send
    response = await self._send_handling_auth(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1645: in _send_handling_auth
    response = await self._send_handling_redirects(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1682: in _send_handling_redirects
    response = await self._send_single_request(request)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1719: in _send_single_request
    response = await transport.handle_async_request(request)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_transports\asgi.py:162: in handle_async_request
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\applications.py:1106: in __call__
    await super().__call__(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\applications.py:122: in __call__
    await self.middleware_stack(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:184: in __call__
    raise exc
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:162: in __call__
    await self.app(scope, receive, _send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\cors.py:83: in __call__
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:79: in __call__
    raise exc
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:68: in __call__
    await self.app(scope, receive, sender)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:20: in __call__
    raise e
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:17: in __call__
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:718: in __call__
    await route.handle(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:276: in handle
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:66: in app
    response = await func(request)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:274: in app
    raw_response = await run_endpoint_function(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:191: in run_endpoint_function
    return await dependant.call(**values)
app.py:217: in get_queue_state_debug
    state = await repo.get_queue_state_raw(poi_id)
db\repositories.py:204: in get_queue_state_raw
    result = await self.session.execute(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\ext\asyncio\session.py:455: in execute
    result = await greenlet_spawn(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py:190: in greenlet_spawn
    result = context.throw(*sys.exc_info())
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2308: in execute
    return self._execute_internal(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2180: in _execute_internal
    conn = self._connection_for_bind(bind)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2047: in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
<string>:2: in _connection_for_bind
    ???
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state_changes.py:139: in _go
    ret_value = fn(self, *arg, **kw)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:1143: in _connection_for_bind
    conn = bind.connect()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:3268: in connect
    return self._connection_cls(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:145: in __init__
    self._dbapi_connection = engine.raw_connection()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:3292: in raw_connection
    return self.pool.connect()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:452: in connect
    return _ConnectionFairy._checkout(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:1269: in _checkout
    fairy = _ConnectionRecord.checkout(pool)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:716: in checkout
    rec = pool._do_get()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\impl.py:169: in _do_get
    with util.safe_reraise():
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:146: in __exit__
    raise exc_value.with_traceback(exc_tb)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\impl.py:167: in _do_get
    return self._create_connection()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:393: in _create_connection
    return _ConnectionRecord(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:678: in __init__
    self.__connect()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:902: in __connect
    with util.safe_reraise():
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:146: in __exit__
    raise exc_value.with_traceback(exc_tb)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:898: in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\create.py:637: in connect
    return dialect.connect(*cargs, **cparams)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\default.py:616: in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py:936: in connect
    await_only(creator_fn(*arg, **kw)),
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py:125: in await_only
    return current.driver.switch(awaitable)  # type: ignore[no-any-return]
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py:185: in greenlet_spawn
    value = await result
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connection.py:2329: in connect
    return await connect_utils._connect(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connect_utils.py:991: in _connect
    conn = await _connect_addr(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connect_utils.py:828: in _connect_addr
    return await __connect_addr(params, True, *args)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

params = ConnectionParameters(user='postgres', password='postgres', database='stadium_waittime', ssl=<ssl.SSLContext object at ...slmode=<SSLMode.prefer: 2>, direct_tls=False, server_settings=None, target_session_attrs=<SessionAttribute.any: 'any'>)
retry = True, addr = ('localhost', 5432)
loop = <ProactorEventLoop running=False closed=False debug=False>
config = ConnectionConfiguration(command_timeout=None, statement_cache_size=100, max_cached_statement_lifetime=300, max_cacheable_statement_size=15360)
connection_class = <class 'asyncpg.connection.Connection'>
record_class = <class 'asyncpg.Record'>
params_input = ConnectionParameters(user='postgres', password='postgres', database='stadium_waittime', ssl=<ssl.SSLContext object at ...slmode=<SSLMode.prefer: 2>, direct_tls=False, server_settings=None, target_session_attrs=<SessionAttribute.any: 'any'>)

    async def __connect_addr(
        params,
        retry,
        addr,
        loop,
        config,
        connection_class,
        record_class,
        params_input,
    ):
        connected = _create_future(loop)
    
        proto_factory = lambda: protocol.Protocol(
            addr, connected, params, record_class, loop)
    
        if isinstance(addr, str):
            # UNIX socket
            connector = loop.create_unix_connection(proto_factory, addr)
    
        elif params.ssl and params.direct_tls:
            # if ssl and direct_tls are given, skip STARTTLS and perform direct
            # SSL connection
            connector = loop.create_connection(
                proto_factory, *addr, ssl=params.ssl
            )
    
        elif params.ssl:
            connector = _create_ssl_connection(
                proto_factory, *addr, loop=loop, ssl_context=params.ssl,
                ssl_is_advisory=params.sslmode == SSLMode.prefer)
        else:
            connector = loop.create_connection(proto_factory, *addr)
    
        tr, pr = await connector
    
        try:
>           await connected
E           asyncpg.exceptions.InvalidPasswordError: password authentication failed for user "postgres"

C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connect_utils.py:876: InvalidPasswordError
______________ TestResponseModels.test_wait_time_response_model _______________

self = <tests.test_app.TestResponseModels object at 0x000001A88DAFB7D0>
test_client = <httpx.AsyncClient object at 0x000001A890A31A90>
test_db_session = <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x000001A890A31410>
seed_pois = [{'id': 'WC-Norte-L0-1', 'name': 'Restrooms North Level 0 #1', 'num_servers': 8, 'poi_type': 'restroom', ...}, {'id': ...ype': 'restroom', ...}, {'id': 'Food-Sul-1', 'name': 'Food Court South #1', 'num_servers': 4, 'poi_type': 'food', ...}]
seed_queue_states = [{'arrival_rate': 2.5, 'confidence_lower': 4.0, 'confidence_upper': 6.5, 'current_wait_minutes': 5.2, ...}, {'arrival_... 3.1, ...}, {'arrival_rate': 3.2, 'confidence_lower': 7.0, 'confidence_upper': 10.5, 'current_wait_minutes': 8.7, ...}]

    @pytest.mark.asyncio
    async def test_wait_time_response_model(self, test_client, test_db_session, seed_pois, seed_queue_states):
        """Test that wait time response matches WaitTimeResponse model"""
>       response = await test_client.get("/api/waittime?poi=WC-Norte-L0-1")

tests\test_app.py:228: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1757: in get
    return await self.request(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1530: in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1617: in send
    response = await self._send_handling_auth(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1645: in _send_handling_auth
    response = await self._send_handling_redirects(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1682: in _send_handling_redirects
    response = await self._send_single_request(request)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1719: in _send_single_request
    response = await transport.handle_async_request(request)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_transports\asgi.py:162: in handle_async_request
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\applications.py:1106: in __call__
    await super().__call__(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\applications.py:122: in __call__
    await self.middleware_stack(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:184: in __call__
    raise exc
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:162: in __call__
    await self.app(scope, receive, _send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\cors.py:83: in __call__
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:79: in __call__
    raise exc
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:68: in __call__
    await self.app(scope, receive, sender)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:20: in __call__
    raise e
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:17: in __call__
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:718: in __call__
    await route.handle(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:276: in handle
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:66: in app
    response = await func(request)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:274: in app
    raw_response = await run_endpoint_function(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:191: in run_endpoint_function
    return await dependant.call(**values)
app.py:139: in get_wait_time
    wait_time = await repo.get_current_wait_time(poi)
db\repositories.py:158: in get_current_wait_time
    result = await self.session.execute(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\ext\asyncio\session.py:455: in execute
    result = await greenlet_spawn(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py:190: in greenlet_spawn
    result = context.throw(*sys.exc_info())
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2308: in execute
    return self._execute_internal(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2180: in _execute_internal
    conn = self._connection_for_bind(bind)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2047: in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
<string>:2: in _connection_for_bind
    ???
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state_changes.py:139: in _go
    ret_value = fn(self, *arg, **kw)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:1143: in _connection_for_bind
    conn = bind.connect()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:3268: in connect
    return self._connection_cls(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:145: in __init__
    self._dbapi_connection = engine.raw_connection()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:3292: in raw_connection
    return self.pool.connect()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:452: in connect
    return _ConnectionFairy._checkout(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:1269: in _checkout
    fairy = _ConnectionRecord.checkout(pool)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:716: in checkout
    rec = pool._do_get()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\impl.py:169: in _do_get
    with util.safe_reraise():
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:146: in __exit__
    raise exc_value.with_traceback(exc_tb)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\impl.py:167: in _do_get
    return self._create_connection()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:393: in _create_connection
    return _ConnectionRecord(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:678: in __init__
    self.__connect()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:902: in __connect
    with util.safe_reraise():
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:146: in __exit__
    raise exc_value.with_traceback(exc_tb)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:898: in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\create.py:637: in connect
    return dialect.connect(*cargs, **cparams)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\default.py:616: in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py:936: in connect
    await_only(creator_fn(*arg, **kw)),
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py:125: in await_only
    return current.driver.switch(awaitable)  # type: ignore[no-any-return]
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py:185: in greenlet_spawn
    value = await result
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connection.py:2329: in connect
    return await connect_utils._connect(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connect_utils.py:991: in _connect
    conn = await _connect_addr(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connect_utils.py:828: in _connect_addr
    return await __connect_addr(params, True, *args)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

params = ConnectionParameters(user='postgres', password='postgres', database='stadium_waittime', ssl=<ssl.SSLContext object at ...slmode=<SSLMode.prefer: 2>, direct_tls=False, server_settings=None, target_session_attrs=<SessionAttribute.any: 'any'>)
retry = True, addr = ('localhost', 5432)
loop = <ProactorEventLoop running=False closed=False debug=False>
config = ConnectionConfiguration(command_timeout=None, statement_cache_size=100, max_cached_statement_lifetime=300, max_cacheable_statement_size=15360)
connection_class = <class 'asyncpg.connection.Connection'>
record_class = <class 'asyncpg.Record'>
params_input = ConnectionParameters(user='postgres', password='postgres', database='stadium_waittime', ssl=<ssl.SSLContext object at ...slmode=<SSLMode.prefer: 2>, direct_tls=False, server_settings=None, target_session_attrs=<SessionAttribute.any: 'any'>)

    async def __connect_addr(
        params,
        retry,
        addr,
        loop,
        config,
        connection_class,
        record_class,
        params_input,
    ):
        connected = _create_future(loop)
    
        proto_factory = lambda: protocol.Protocol(
            addr, connected, params, record_class, loop)
    
        if isinstance(addr, str):
            # UNIX socket
            connector = loop.create_unix_connection(proto_factory, addr)
    
        elif params.ssl and params.direct_tls:
            # if ssl and direct_tls are given, skip STARTTLS and perform direct
            # SSL connection
            connector = loop.create_connection(
                proto_factory, *addr, ssl=params.ssl
            )
    
        elif params.ssl:
            connector = _create_ssl_connection(
                proto_factory, *addr, loop=loop, ssl_context=params.ssl,
                ssl_is_advisory=params.sslmode == SSLMode.prefer)
        else:
            connector = loop.create_connection(proto_factory, *addr)
    
        tr, pr = await connector
    
        try:
>           await connected
E           asyncpg.exceptions.InvalidPasswordError: password authentication failed for user "postgres"

C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connect_utils.py:876: InvalidPasswordError
_______________ TestResponseModels.test_poi_info_response_model _______________

self = <tests.test_app.TestResponseModels object at 0x000001A88DAF1150>
test_client = <httpx.AsyncClient object at 0x000001A88FC14C50>
test_db_session = <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x000001A88FC16910>
seed_pois = [{'id': 'WC-Norte-L0-1', 'name': 'Restrooms North Level 0 #1', 'num_servers': 8, 'poi_type': 'restroom', ...}, {'id': ...ype': 'restroom', ...}, {'id': 'Food-Sul-1', 'name': 'Food Court South #1', 'num_servers': 4, 'poi_type': 'food', ...}]

    @pytest.mark.asyncio
    async def test_poi_info_response_model(self, test_client, test_db_session, seed_pois):
        """Test that POI response matches POIInfo model"""
>       response = await test_client.get("/api/poi/WC-Norte-L0-1")

tests\test_app.py:247: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1757: in get
    return await self.request(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1530: in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1617: in send
    response = await self._send_handling_auth(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1645: in _send_handling_auth
    response = await self._send_handling_redirects(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1682: in _send_handling_redirects
    response = await self._send_single_request(request)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1719: in _send_single_request
    response = await transport.handle_async_request(request)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_transports\asgi.py:162: in handle_async_request
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\applications.py:1106: in __call__
    await super().__call__(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\applications.py:122: in __call__
    await self.middleware_stack(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:184: in __call__
    raise exc
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:162: in __call__
    await self.app(scope, receive, _send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\cors.py:83: in __call__
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:79: in __call__
    raise exc
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:68: in __call__
    await self.app(scope, receive, sender)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:20: in __call__
    raise e
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:17: in __call__
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:718: in __call__
    await route.handle(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:276: in handle
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:66: in app
    response = await func(request)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:274: in app
    raw_response = await run_endpoint_function(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:191: in run_endpoint_function
    return await dependant.call(**values)
app.py:197: in get_poi_details
    poi = await repo.get_poi_by_id(poi_id)
db\repositories.py:36: in get_poi_by_id
    result = await self.session.execute(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\ext\asyncio\session.py:455: in execute
    result = await greenlet_spawn(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py:190: in greenlet_spawn
    result = context.throw(*sys.exc_info())
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2308: in execute
    return self._execute_internal(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2180: in _execute_internal
    conn = self._connection_for_bind(bind)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2047: in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
<string>:2: in _connection_for_bind
    ???
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state_changes.py:139: in _go
    ret_value = fn(self, *arg, **kw)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:1143: in _connection_for_bind
    conn = bind.connect()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:3268: in connect
    return self._connection_cls(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:145: in __init__
    self._dbapi_connection = engine.raw_connection()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:3292: in raw_connection
    return self.pool.connect()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:452: in connect
    return _ConnectionFairy._checkout(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:1269: in _checkout
    fairy = _ConnectionRecord.checkout(pool)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:716: in checkout
    rec = pool._do_get()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\impl.py:169: in _do_get
    with util.safe_reraise():
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:146: in __exit__
    raise exc_value.with_traceback(exc_tb)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\impl.py:167: in _do_get
    return self._create_connection()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:393: in _create_connection
    return _ConnectionRecord(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:678: in __init__
    self.__connect()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:902: in __connect
    with util.safe_reraise():
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:146: in __exit__
    raise exc_value.with_traceback(exc_tb)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:898: in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\create.py:637: in connect
    return dialect.connect(*cargs, **cparams)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\default.py:616: in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py:936: in connect
    await_only(creator_fn(*arg, **kw)),
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py:125: in await_only
    return current.driver.switch(awaitable)  # type: ignore[no-any-return]
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py:185: in greenlet_spawn
    value = await result
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connection.py:2329: in connect
    return await connect_utils._connect(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connect_utils.py:991: in _connect
    conn = await _connect_addr(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connect_utils.py:828: in _connect_addr
    return await __connect_addr(params, True, *args)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

params = ConnectionParameters(user='postgres', password='postgres', database='stadium_waittime', ssl=<ssl.SSLContext object at ...slmode=<SSLMode.prefer: 2>, direct_tls=False, server_settings=None, target_session_attrs=<SessionAttribute.any: 'any'>)
retry = True, addr = ('localhost', 5432)
loop = <ProactorEventLoop running=False closed=False debug=False>
config = ConnectionConfiguration(command_timeout=None, statement_cache_size=100, max_cached_statement_lifetime=300, max_cacheable_statement_size=15360)
connection_class = <class 'asyncpg.connection.Connection'>
record_class = <class 'asyncpg.Record'>
params_input = ConnectionParameters(user='postgres', password='postgres', database='stadium_waittime', ssl=<ssl.SSLContext object at ...slmode=<SSLMode.prefer: 2>, direct_tls=False, server_settings=None, target_session_attrs=<SessionAttribute.any: 'any'>)

    async def __connect_addr(
        params,
        retry,
        addr,
        loop,
        config,
        connection_class,
        record_class,
        params_input,
    ):
        connected = _create_future(loop)
    
        proto_factory = lambda: protocol.Protocol(
            addr, connected, params, record_class, loop)
    
        if isinstance(addr, str):
            # UNIX socket
            connector = loop.create_unix_connection(proto_factory, addr)
    
        elif params.ssl and params.direct_tls:
            # if ssl and direct_tls are given, skip STARTTLS and perform direct
            # SSL connection
            connector = loop.create_connection(
                proto_factory, *addr, ssl=params.ssl
            )
    
        elif params.ssl:
            connector = _create_ssl_connection(
                proto_factory, *addr, loop=loop, ssl_context=params.ssl,
                ssl_is_advisory=params.sslmode == SSLMode.prefer)
        else:
            connector = loop.create_connection(proto_factory, *addr)
    
        tr, pr = await connector
    
        try:
>           await connected
E           asyncpg.exceptions.InvalidPasswordError: password authentication failed for user "postgres"

C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connect_utils.py:876: InvalidPasswordError
____________ TestAPIIntegration.test_api_poi_to_wait_time_workflow ____________

self = <tests.test_integration.TestAPIIntegration object at 0x000001A88DB0C150>
test_client = <httpx.AsyncClient object at 0x000001A88FCA59D0>
test_db_session = <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x000001A88FCA4D90>

    @pytest.mark.asyncio
    @pytest.mark.integration
    async def test_api_poi_to_wait_time_workflow(self, test_client, test_db_session):
        """Test complete workflow via API: POI creation -> wait time update -> query"""
        # Insert POI directly via database
        poi_repo = POIRepository(test_db_session)
        poi_data = {
            "id": "API-Test-POI",
            "name": "API Test POI",
            "type": "store",
            "num_servers": 2,
            "service_rate": 0.3
        }
        await poi_repo.insert_poi(poi_data)
    
        # Insert wait time
        wait_repo = WaitTimeRepository(test_db_session)
        await wait_repo.update_queue_state(
            poi_id="API-Test-POI",
            arrival_rate=1.2,
            wait_minutes=4.5,
            confidence_lower=3.8,
            confidence_upper=5.2,
            sample_count=12,
            status="medium"
        )
    
        # Query via API
>       response = await test_client.get("/api/poi/API-Test-POI")

tests\test_integration.py:234: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1757: in get
    return await self.request(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1530: in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1617: in send
    response = await self._send_handling_auth(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1645: in _send_handling_auth
    response = await self._send_handling_redirects(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1682: in _send_handling_redirects
    response = await self._send_single_request(request)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1719: in _send_single_request
    response = await transport.handle_async_request(request)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_transports\asgi.py:162: in handle_async_request
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\applications.py:1106: in __call__
    await super().__call__(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\applications.py:122: in __call__
    await self.middleware_stack(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:184: in __call__
    raise exc
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:162: in __call__
    await self.app(scope, receive, _send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\cors.py:83: in __call__
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:79: in __call__
    raise exc
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:68: in __call__
    await self.app(scope, receive, sender)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:20: in __call__
    raise e
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:17: in __call__
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:718: in __call__
    await route.handle(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:276: in handle
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:66: in app
    response = await func(request)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:274: in app
    raw_response = await run_endpoint_function(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:191: in run_endpoint_function
    return await dependant.call(**values)
app.py:197: in get_poi_details
    poi = await repo.get_poi_by_id(poi_id)
db\repositories.py:36: in get_poi_by_id
    result = await self.session.execute(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\ext\asyncio\session.py:455: in execute
    result = await greenlet_spawn(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py:190: in greenlet_spawn
    result = context.throw(*sys.exc_info())
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2308: in execute
    return self._execute_internal(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2180: in _execute_internal
    conn = self._connection_for_bind(bind)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2047: in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
<string>:2: in _connection_for_bind
    ???
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state_changes.py:139: in _go
    ret_value = fn(self, *arg, **kw)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:1143: in _connection_for_bind
    conn = bind.connect()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:3268: in connect
    return self._connection_cls(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:145: in __init__
    self._dbapi_connection = engine.raw_connection()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:3292: in raw_connection
    return self.pool.connect()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:452: in connect
    return _ConnectionFairy._checkout(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:1269: in _checkout
    fairy = _ConnectionRecord.checkout(pool)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:716: in checkout
    rec = pool._do_get()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\impl.py:169: in _do_get
    with util.safe_reraise():
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:146: in __exit__
    raise exc_value.with_traceback(exc_tb)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\impl.py:167: in _do_get
    return self._create_connection()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:393: in _create_connection
    return _ConnectionRecord(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:678: in __init__
    self.__connect()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:902: in __connect
    with util.safe_reraise():
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:146: in __exit__
    raise exc_value.with_traceback(exc_tb)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:898: in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\create.py:637: in connect
    return dialect.connect(*cargs, **cparams)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\default.py:616: in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py:936: in connect
    await_only(creator_fn(*arg, **kw)),
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py:125: in await_only
    return current.driver.switch(awaitable)  # type: ignore[no-any-return]
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py:185: in greenlet_spawn
    value = await result
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connection.py:2329: in connect
    return await connect_utils._connect(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connect_utils.py:991: in _connect
    conn = await _connect_addr(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connect_utils.py:828: in _connect_addr
    return await __connect_addr(params, True, *args)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

params = ConnectionParameters(user='postgres', password='postgres', database='stadium_waittime', ssl=<ssl.SSLContext object at ...slmode=<SSLMode.prefer: 2>, direct_tls=False, server_settings=None, target_session_attrs=<SessionAttribute.any: 'any'>)
retry = True, addr = ('localhost', 5432)
loop = <ProactorEventLoop running=False closed=False debug=False>
config = ConnectionConfiguration(command_timeout=None, statement_cache_size=100, max_cached_statement_lifetime=300, max_cacheable_statement_size=15360)
connection_class = <class 'asyncpg.connection.Connection'>
record_class = <class 'asyncpg.Record'>
params_input = ConnectionParameters(user='postgres', password='postgres', database='stadium_waittime', ssl=<ssl.SSLContext object at ...slmode=<SSLMode.prefer: 2>, direct_tls=False, server_settings=None, target_session_attrs=<SessionAttribute.any: 'any'>)

    async def __connect_addr(
        params,
        retry,
        addr,
        loop,
        config,
        connection_class,
        record_class,
        params_input,
    ):
        connected = _create_future(loop)
    
        proto_factory = lambda: protocol.Protocol(
            addr, connected, params, record_class, loop)
    
        if isinstance(addr, str):
            # UNIX socket
            connector = loop.create_unix_connection(proto_factory, addr)
    
        elif params.ssl and params.direct_tls:
            # if ssl and direct_tls are given, skip STARTTLS and perform direct
            # SSL connection
            connector = loop.create_connection(
                proto_factory, *addr, ssl=params.ssl
            )
    
        elif params.ssl:
            connector = _create_ssl_connection(
                proto_factory, *addr, loop=loop, ssl_context=params.ssl,
                ssl_is_advisory=params.sslmode == SSLMode.prefer)
        else:
            connector = loop.create_connection(proto_factory, *addr)
    
        tr, pr = await connector
    
        try:
>           await connected
E           asyncpg.exceptions.InvalidPasswordError: password authentication failed for user "postgres"

C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connect_utils.py:876: InvalidPasswordError
______________ TestAPIIntegration.test_api_list_all_with_filters ______________

self = <tests.test_integration.TestAPIIntegration object at 0x000001A88DB0C850>
test_client = <httpx.AsyncClient object at 0x000001A88FF7B010>
test_db_session = <sqlalchemy.ext.asyncio.session.AsyncSession object at 0x000001A88FF79250>
sample_pois = [{'id': 'WC-Norte-L0-1', 'name': 'Restrooms North Level 0 #1', 'num_servers': 8, 'service_rate': 0.5, ...}, {'id': 'Fo...'service_rate': 0.4, ...}, {'id': 'Store-Este-1', 'name': 'Store East #1', 'num_servers': 2, 'service_rate': 0.3, ...}]

    @pytest.mark.asyncio
    @pytest.mark.integration
    async def test_api_list_all_with_filters(self, test_client, test_db_session, sample_pois):
        """Test listing POIs and wait times with type filters"""
        # Insert multiple POIs
        poi_repo = POIRepository(test_db_session)
        wait_repo = WaitTimeRepository(test_db_session)
    
        for i, poi_data in enumerate(sample_pois):
            await poi_repo.insert_poi(poi_data)
    
            # Add wait times
            await wait_repo.update_queue_state(
                poi_id=poi_data['id'],
                arrival_rate=float(i + 1),
                wait_minutes=float((i + 1) * 2),
                confidence_lower=float(i + 1),
                confidence_upper=float((i + 1) * 3),
                sample_count=10,
                status="low"
            )
    
        # Get all POIs
>       response = await test_client.get("/api/pois")

tests\test_integration.py:270: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1757: in get
    return await self.request(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1530: in request
    return await self.send(request, auth=auth, follow_redirects=follow_redirects)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1617: in send
    response = await self._send_handling_auth(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1645: in _send_handling_auth
    response = await self._send_handling_redirects(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1682: in _send_handling_redirects
    response = await self._send_single_request(request)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_client.py:1719: in _send_single_request
    response = await transport.handle_async_request(request)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\httpx\_transports\asgi.py:162: in handle_async_request
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\applications.py:1106: in __call__
    await super().__call__(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\applications.py:122: in __call__
    await self.middleware_stack(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:184: in __call__
    raise exc
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\errors.py:162: in __call__
    await self.app(scope, receive, _send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\cors.py:83: in __call__
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:79: in __call__
    raise exc
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\middleware\exceptions.py:68: in __call__
    await self.app(scope, receive, sender)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:20: in __call__
    raise e
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\middleware\asyncexitstack.py:17: in __call__
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:718: in __call__
    await route.handle(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:276: in handle
    await self.app(scope, receive, send)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\starlette\routing.py:66: in app
    response = await func(request)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:274: in app
    raw_response = await run_endpoint_function(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\fastapi\routing.py:191: in run_endpoint_function
    return await dependant.call(**values)
app.py:182: in get_pois
    pois = await repo.get_all_pois(poi_type=poi_type)
db\repositories.py:57: in get_all_pois
    result = await self.session.execute(query)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\ext\asyncio\session.py:455: in execute
    result = await greenlet_spawn(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py:190: in greenlet_spawn
    result = context.throw(*sys.exc_info())
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2308: in execute
    return self._execute_internal(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2180: in _execute_internal
    conn = self._connection_for_bind(bind)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:2047: in _connection_for_bind
    return trans._connection_for_bind(engine, execution_options)
<string>:2: in _connection_for_bind
    ???
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\state_changes.py:139: in _go
    ret_value = fn(self, *arg, **kw)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\orm\session.py:1143: in _connection_for_bind
    conn = bind.connect()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:3268: in connect
    return self._connection_cls(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:145: in __init__
    self._dbapi_connection = engine.raw_connection()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\base.py:3292: in raw_connection
    return self.pool.connect()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:452: in connect
    return _ConnectionFairy._checkout(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:1269: in _checkout
    fairy = _ConnectionRecord.checkout(pool)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:716: in checkout
    rec = pool._do_get()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\impl.py:169: in _do_get
    with util.safe_reraise():
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:146: in __exit__
    raise exc_value.with_traceback(exc_tb)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\impl.py:167: in _do_get
    return self._create_connection()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:393: in _create_connection
    return _ConnectionRecord(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:678: in __init__
    self.__connect()
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:902: in __connect
    with util.safe_reraise():
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\langhelpers.py:146: in __exit__
    raise exc_value.with_traceback(exc_tb)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\pool\base.py:898: in __connect
    self.dbapi_connection = connection = pool._invoke_creator(self)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\create.py:637: in connect
    return dialect.connect(*cargs, **cparams)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\engine\default.py:616: in connect
    return self.loaded_dbapi.connect(*cargs, **cparams)
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\dialects\postgresql\asyncpg.py:936: in connect
    await_only(creator_fn(*arg, **kw)),
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py:125: in await_only
    return current.driver.switch(awaitable)  # type: ignore[no-any-return]
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\sqlalchemy\util\_concurrency_py3k.py:185: in greenlet_spawn
    value = await result
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connection.py:2329: in connect
    return await connect_utils._connect(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connect_utils.py:991: in _connect
    conn = await _connect_addr(
C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connect_utils.py:828: in _connect_addr
    return await __connect_addr(params, True, *args)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

params = ConnectionParameters(user='postgres', password='postgres', database='stadium_waittime', ssl=<ssl.SSLContext object at ...slmode=<SSLMode.prefer: 2>, direct_tls=False, server_settings=None, target_session_attrs=<SessionAttribute.any: 'any'>)
retry = True, addr = ('localhost', 5432)
loop = <ProactorEventLoop running=False closed=False debug=False>
config = ConnectionConfiguration(command_timeout=None, statement_cache_size=100, max_cached_statement_lifetime=300, max_cacheable_statement_size=15360)
connection_class = <class 'asyncpg.connection.Connection'>
record_class = <class 'asyncpg.Record'>
params_input = ConnectionParameters(user='postgres', password='postgres', database='stadium_waittime', ssl=<ssl.SSLContext object at ...slmode=<SSLMode.prefer: 2>, direct_tls=False, server_settings=None, target_session_attrs=<SessionAttribute.any: 'any'>)

    async def __connect_addr(
        params,
        retry,
        addr,
        loop,
        config,
        connection_class,
        record_class,
        params_input,
    ):
        connected = _create_future(loop)
    
        proto_factory = lambda: protocol.Protocol(
            addr, connected, params, record_class, loop)
    
        if isinstance(addr, str):
            # UNIX socket
            connector = loop.create_unix_connection(proto_factory, addr)
    
        elif params.ssl and params.direct_tls:
            # if ssl and direct_tls are given, skip STARTTLS and perform direct
            # SSL connection
            connector = loop.create_connection(
                proto_factory, *addr, ssl=params.ssl
            )
    
        elif params.ssl:
            connector = _create_ssl_connection(
                proto_factory, *addr, loop=loop, ssl_context=params.ssl,
                ssl_is_advisory=params.sslmode == SSLMode.prefer)
        else:
            connector = loop.create_connection(proto_factory, *addr)
    
        tr, pr = await connector
    
        try:
>           await connected
E           asyncpg.exceptions.InvalidPasswordError: password authentication failed for user "postgres"

C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\asyncpg\connect_utils.py:876: InvalidPasswordError
============================== warnings summary ===============================
..\..\..\..\..\AppData\Local\Programs\Python\Python311\Lib\site-packages\pydantic\_internal\_config.py:268
..\..\..\..\..\AppData\Local\Programs\Python\Python311\Lib\site-packages\pydantic\_internal\_config.py:268
..\..\..\..\..\AppData\Local\Programs\Python\Python311\Lib\site-packages\pydantic\_internal\_config.py:268
..\..\..\..\..\AppData\Local\Programs\Python\Python311\Lib\site-packages\pydantic\_internal\_config.py:268
  C:\Users\joaov\AppData\Local\Programs\Python\Python311\Lib\site-packages\pydantic\_internal\_config.py:268: PydanticDeprecatedSince20: Support for class-based `config` is deprecated, use ConfigDict instead. Deprecated in Pydantic V2.0 to be removed in V3.0. See Pydantic V2 Migration Guide at https://errors.pydantic.dev/2.5/migration/
    warnings.warn(DEPRECATION_MESSAGE, DeprecationWarning)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ===========================
FAILED tests/test_app.py::TestWaitTimeEndpoints::test_get_wait_time_success
FAILED tests/test_app.py::TestWaitTimeEndpoints::test_get_wait_time_not_found
FAILED tests/test_app.py::TestWaitTimeEndpoints::test_get_all_wait_times - as...
FAILED tests/test_app.py::TestWaitTimeEndpoints::test_get_all_wait_times_filtered_by_type
FAILED tests/test_app.py::TestWaitTimeEndpoints::test_get_all_wait_times_empty
FAILED tests/test_app.py::TestPOIEndpoints::test_get_all_pois - asyncpg.excep...
FAILED tests/test_app.py::TestPOIEndpoints::test_get_pois_filtered_by_type - ...
FAILED tests/test_app.py::TestPOIEndpoints::test_get_pois_empty - asyncpg.exc...
FAILED tests/test_app.py::TestPOIEndpoints::test_get_poi_by_id_success - asyn...
FAILED tests/test_app.py::TestPOIEndpoints::test_get_poi_by_id_not_found - as...
FAILED tests/test_app.py::TestDebugEndpoints::test_get_queue_state_debug - as...
FAILED tests/test_app.py::TestDebugEndpoints::test_get_queue_state_debug_not_found
FAILED tests/test_app.py::TestResponseModels::test_wait_time_response_model
FAILED tests/test_app.py::TestResponseModels::test_poi_info_response_model - ...
FAILED tests/test_integration.py::TestAPIIntegration::test_api_poi_to_wait_time_workflow
FAILED tests/test_integration.py::TestAPIIntegration::test_api_list_all_with_filters
================= 16 failed, 80 passed, 4 warnings in 15.55s ==================
